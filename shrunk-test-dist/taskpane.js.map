{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html","webpack://office-addin-taskpane/./node_modules/.pnpm/html-loader@4.2.0_webpack@5.89.0/node_modules/html-loader/dist/runtime/getUrl.js","webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/compat get default export","webpack://office-addin-taskpane/webpack/runtime/define property getters","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/webpack/startup"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n/* global document, Office */\n\nconst ONLY_ALLOW_RUTGERS_LINKS = false;\n\n/**\n * This function gets the tracking pixel from the body of the mailbox item and performs the callback function on it\n * @param callback function to perform on the tracking pixel\n */\nfunction getAsyncTrackingPixels(callback: (trackingPixels: NodeListOf<Element>) => void) {\n  Office.context.mailbox.item.body.getAsync(\"html\", {}, function (result) {\n    let html = result.value;\n    let dummy = document.createElement(\"div\");\n    dummy.innerHTML = html;\n    let trackingPixels = dummy.querySelectorAll(`img[title='${TRACKING_PIXEL_TITLE}']`);\n    callback(trackingPixels);\n  });\n}\n\nfunction getAlias(url: string) {\n  // confirm that the url is from shrunk.rutgers.edu or go.rutgers.edu\n  url = url.replace(/(https|http):\\/\\//, \"\");\n  if (!url.match(/(shrunk|go)\\.rutgers\\.edu/)) {\n    // get rid of the http(s)://\n\n    // get rid of the www.\n    url = url.replace(\"www.\", \"\");\n    return url;\n  }\n  let alias = url.split(\"/\")[1];\n  return alias;\n}\n\n// function updateShrunkLinkDetectionMessage() {\n//   getAsyncTrackingPixels((tracking_pixels) => {\n//     if (tracking_pixels != null) {\n//       document.getElementById(\"shrunk-link-detected\").style.visibility = \"visible\";\n//       const shrunkUrl = tracking_pixel.getAttribute(\"src\");\n//       document.getElementById(\"shrunk-link-detected-url\").textContent = shrunkUrl;\n//     } else {\n//       document.getElementById(\"shrunk-link-detected\").style.visibility = \"hidden\";\n//     }\n//   });\n// }\nlet insertLock = false;\nlet loadLock = false;\nlet highlightLock = false;\nlet prevChildNodes = [];\n\nfunction loadTrackingPixels() {\n  if (insertLock || loadLock || highlightLock) return;\n  loadLock = true;\n  getAsyncTrackingPixels((trackingPixels) => {\n    let container = document.getElementById(\"inserted-tracking-pixels-container\");\n    let childNodes = [];\n\n    if (trackingPixels.length == 0) {\n      document.getElementById(\"no-inserted-detected\").style.display = \"block\";\n      document.getElementById(\"inserted-detection-instruction\").style.display = \"none\";\n    } else {\n      document.getElementById(\"no-inserted-detected\").style.display = \"none\";\n      document.getElementById(\"inserted-detection-instruction\").style.display = \"block\";\n    }\n\n    trackingPixels.forEach((trackingPixel) => {\n      let url = trackingPixel.getAttribute(\"src\");\n      let newTrackingPixel = getTrackingPixelDiv(url);\n      childNodes.push(newTrackingPixel);\n    });\n\n    if (childNodes.length != prevChildNodes.length) {\n      container.replaceChildren(...childNodes);\n      prevChildNodes = childNodes;\n      loadLock = false;\n    } else {\n      for (let i = 0; i < childNodes.length; i++) {\n        if (childNodes[i].title != prevChildNodes[i].title) {\n          container.replaceChildren(...childNodes);\n          prevChildNodes = childNodes;\n          loadLock = false;\n          return;\n        }\n      }\n      loadLock = false;\n    }\n  });\n}\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Outlook) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n    // loads all tracking pixels into the tracking pixel container when the extension is opened\n    loadTrackingPixels();\n    document.getElementById(\"inserted-tracking-pixels-container\").childNodes.forEach((child) => {\n      prevChildNodes.push(child);\n    });\n    let insertButton = document.getElementById(\"insert\");\n    insertLock = false;\n    insertButton.onclick = () => {\n      if (insertLock) return;\n      insertLock = true;\n      insert();\n    };\n    setInterval(loadTrackingPixels, 500);\n  }\n});\n\nconst TRACKING_PIXEL_TITLE = \"__shrunk_tracking_pixel__\";\n\nexport async function insert() {\n  const urlItem = document.getElementById(\"tracking-pixel-url\") as HTMLInputElement;\n  urlItem.value = urlItem.value.trim();\n  let error = false;\n  if (!urlItem.value.match(/(https|http):\\/\\//)) {\n    Office.context.mailbox.item.notificationMessages.replaceAsync(\"notify\", {\n      type: \"informationalMessage\",\n      message: \"Please enter a valid image url\",\n      icon: \"iconid\",\n      persistent: false,\n    });\n    error = true;\n  }\n  if (ONLY_ALLOW_RUTGERS_LINKS && !urlItem.value.match(/^https?:\\/\\/(shrunk|go)\\.rutgers\\.edu\\/.*\\.(png|gif)$/)) {\n    Office.context.mailbox.item.notificationMessages.replaceAsync(\"notify\", {\n      type: \"errorMessage\",\n      message: \"Only go or shrunk links are allowed\",\n    });\n    error = true;\n  }\n  if (error) {\n    insertLock = false; // release the lock if there is an error\n    return;\n  }\n  //check if tracking_img_id exists in body of the mailbox item\n\n  getAsyncTrackingPixels((trackingPixels) => {\n    trackingPixels.forEach((trackingPixel) => {\n      if (trackingPixel.getAttribute(\"src\") == urlItem.value) {\n        Office.context.mailbox.item.notificationMessages.replaceAsync(\"notify\", {\n          type: \"errorMessage\",\n          message: \"Tracking pixel already inserted\",\n        });\n        error = true;\n        return;\n      }\n    });\n    if (error) {\n      insertLock = false; // release the lock if there is an error\n      return;\n    }\n    Office.context.mailbox.item.body.prependAsync(\n      `<img title=\"${TRACKING_PIXEL_TITLE}\" src=\"${urlItem.value}\" />`,\n      {\n        coercionType: Office.CoercionType.Html,\n      },\n      () => {\n        // release the lock once the tracking pixel is inserted\n        insertLock = false;\n      }\n    );\n    Office.context.mailbox.item.notificationMessages.replaceAsync(\"notify\", {\n      type: \"informationalMessage\",\n      message: \"Tracking pixel inserted\",\n      persistent: false,\n      icon: \"iconid\",\n    });\n\n    let container = document.getElementById(\"inserted-tracking-pixels-container\");\n    let newTrackingPixelDiv = getTrackingPixelDiv(urlItem.value);\n\n    container.appendChild(newTrackingPixelDiv);\n  });\n}\n\nfunction setTrackingPixelBorder(borderStyle: string, src: string, callback: () => void) {\n  Office.context.mailbox.item.body.getAsync(\"html\", {}, function (result) {\n    let oldHTML = result.value;\n    let dummy = document.createElement(\"div\");\n    dummy.innerHTML = oldHTML;\n    let image = dummy.querySelector(`img[src='${src}']`) as HTMLImageElement;\n    if (image == null) return;\n    image.style.border = borderStyle;\n    Office.context.mailbox.item.body.setAsync(dummy.innerHTML, { coercionType: Office.CoercionType.Html }, callback);\n  });\n}\n\nfunction getTrackingPixelDiv(url: string) {\n  let trackingPixelDiv = document.createElement(\"div\");\n  trackingPixelDiv.title = url;\n\n  let text = document.createElement(\"p\");\n  text.innerHTML = getAlias(url);\n  trackingPixelDiv.appendChild(text);\n\n  let removeButton = document.createElement(\"button\");\n  // add the close_svg to the button\n  let img = document.createElement(\"img\");\n  // the svg is located in ../../assets/delete_svg.svg\n  img.src = \"../../assets/delete_svg.svg\";\n  removeButton.appendChild(img);\n\n  removeButton.onclick = (event: MouseEvent) => {\n    event.stopPropagation();\n    trackingPixelDiv.remove();\n    Office.context.mailbox.item.notificationMessages.replaceAsync(\"notify\", {\n      type: \"informationalMessage\",\n      message: \"Tracking pixel removed\",\n      persistent: false,\n      icon: \"iconid\",\n    });\n\n    Office.context.mailbox.item.body.getAsync(\"html\", {}, function (result) {\n      let oldHTML = result.value;\n      let dummy = document.createElement(\"div\");\n      dummy.innerHTML = oldHTML;\n      let allTrackingPixels = dummy.querySelectorAll(`img[title='${TRACKING_PIXEL_TITLE}']`);\n      allTrackingPixels.forEach((image) => {\n        if (image.getAttribute(\"src\") == trackingPixelDiv.title) {\n          image.remove();\n        }\n      });\n      Office.context.mailbox.item.body.setAsync(dummy.innerHTML, { coercionType: Office.CoercionType.Html });\n    });\n  };\n  trackingPixelDiv.onclick = () => {\n    if (highlightLock) return;\n    let removeButton = trackingPixelDiv.querySelector(\"button\");\n    setTrackingPixelBorder(\"5px solid red\", trackingPixelDiv.title, () => { });\n    removeButton.disabled = true;\n    trackingPixelDiv.style.pointerEvents = \"none\";\n    highlightLock = true;\n    setTimeout(() => {\n      trackingPixelDiv.style.pointerEvents = \"auto\";\n      trackingPixelDiv.style.border = \"none\";\n      setTrackingPixelBorder(\"\", trackingPixelDiv.title, () => {\n        highlightLock = false;\n      });\n      removeButton.disabled = false;\n    }, 200);\n  };\n\n  trackingPixelDiv.appendChild(removeButton);\n  return trackingPixelDiv;\n}\n","// Imports\nimport ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___ from \"../../node_modules/.pnpm/html-loader@4.2.0_webpack@5.89.0/node_modules/html-loader/dist/runtime/getUrl.js\";\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"../../assets/RUTGERS_H_RED_BLACK_RGB.png\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_2___ = new URL(\"../../assets/add_svg.svg\", import.meta.url);\n// Module\nvar ___HTML_LOADER_REPLACEMENT_0___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_0___);\nvar ___HTML_LOADER_REPLACEMENT_1___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_1___);\nvar ___HTML_LOADER_REPLACEMENT_2___ = ___HTML_LOADER_GET_SOURCE_FROM_IMPORT___(___HTML_LOADER_IMPORT_2___);\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Shrunk Outlook Add-in</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_REPLACEMENT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please <a target=\\\"_blank\\\" href=\\\"https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing\\\">sideload</a> your add-in to see app body.</h2> </section> <img src=\\\"\" + ___HTML_LOADER_REPLACEMENT_1___ + \"\\\" alt=\\\"\\\" style=\\\"width:60%;margin:5px\\\"> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <h2 class=\\\"ms-font-xl bold\\\"> Enter Tracking Pixel URL </h2> <div style=\\\"width:100%\\\"> <div class=\\\"flex\\\"> <input type=\\\"text\\\" id=\\\"tracking-pixel-url\\\"/> <div id=\\\"insert\\\" class=\\\"button\\\"> <img src=\\\"\" + ___HTML_LOADER_REPLACEMENT_2___ + \"\\\"/> </div> </div> </div> <div class=\\\"container\\\"> <h2>Inserted Tracking Pixels:</h2> <em id=\\\"no-inserted-detected\\\"> None detected </em> <em id=\\\"inserted-detection-instruction\\\">(Click the box to highlight the pixel)</em> <div id=\\\"inserted-tracking-pixels-container\\\"> </div> </div> <span id=\\\"shrunk-link-detected\\\" style=\\\"display:none\\\"> Shrunk link detected: <br/> <a id=\\\"shrunk-link-detected-url\\\" style=\\\"color:#000\\\" href=\\\"\\\"> go.rutgers.edu/yourmom </a> </span> <div class=\\\"instructions tile\\\"> <h3>Instructions</h3> <ol> <li>Create a Tracking Pixel using <a href=\\\"https://go.rutgers.edu\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">go.rutgers.edu</a></li> <li>Paste the link into the box</li> <li>Click '+' button</li> </ol> To remove a Tracking Pixel, press the 'x' button next to it. </div> <div class=\\\"feedback\\\"> <a href=\\\"https://go.rutgers.edu/go-feedback\\\" target=\\\"_blank\\\" rel=\\\"noreferrer noopener\\\">Have Feedback?</a> </div> </main> </body> </html> \";\n// Exports\nexport default code;","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    // eslint-disable-next-line no-param-reassign\n    options = {};\n  }\n\n  if (!url) {\n    return url;\n  } // eslint-disable-next-line no-underscore-dangle, no-param-reassign\n\n\n  url = String(url.__esModule ? url.default : url);\n\n  if (options.hash) {\n    // eslint-disable-next-line no-param-reassign\n    url += options.hash;\n  }\n\n  if (options.maybeNeedQuotes && /[\\t\\n\\f\\r \"'=<>`]/.test(url)) {\n    return \"\\\"\".concat(url, \"\\\"\");\n  }\n\n  return url;\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && !scriptUrl) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t41: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\n__webpack_require__(53211);\nvar __webpack_exports__ = __webpack_require__(53407);\n"],"names":["getAsyncTrackingPixels","callback","Office","context","mailbox","item","body","getAsync","result","html","value","dummy","document","createElement","innerHTML","trackingPixels","querySelectorAll","concat","TRACKING_PIXEL_TITLE","insertLock","loadLock","highlightLock","prevChildNodes","loadTrackingPixels","container","getElementById","childNodes","length","style","display","forEach","trackingPixel","newTrackingPixel","getTrackingPixelDiv","getAttribute","push","replaceChildren","apply","i","title","onReady","info","host","HostType","Outlook","child","insertButton","onclick","insert","setInterval","urlItem","trim","error","match","notificationMessages","replaceAsync","type","message","icon","persistent","prependAsync","coercionType","CoercionType","Html","newTrackingPixelDiv","appendChild","setTrackingPixelBorder","borderStyle","src","oldHTML","image","querySelector","border","setAsync","url","trackingPixelDiv","text","replace","split","getAlias","removeButton","img","event","stopPropagation","remove","disabled","pointerEvents","setTimeout","exports","___HTML_LOADER_IMPORT_0___","URL","___HTML_LOADER_IMPORT_1___","___HTML_LOADER_IMPORT_2___","module","options","String","__esModule","default","hash","maybeNeedQuotes","test","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call","m","n","getter","d","a","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","scriptUrl","importScripts","location","currentScript","scripts","getElementsByTagName","Error","p","b","baseURI","self","href"],"sourceRoot":""}