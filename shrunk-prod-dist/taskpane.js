!function(){"use strict";var e={53211:function(e,t){var n=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}l((i=i.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,i,o,r,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,a[0]&&(c=0)),c;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,i=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){c.label=a[1];break}if(6===a[0]&&c.label<o[1]){c.label=o[1],o=a;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(a);break}o[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(e,c)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}};function o(e){Office.context.mailbox.item.body.getAsync("html",{},(function(t){var n=t.value,i=document.createElement("div");i.innerHTML=n;var o=i.querySelectorAll("img[title='".concat(u,"']"));e(o)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.insert=void 0;var r=!1,c=!1,a=!1,l=[];function s(){r||c||a||(c=!0,o((function(e){var t=document.getElementById("inserted-tracking-pixels-container"),n=[];if(0==e.length?(document.getElementById("no-inserted-detected").style.display="block",document.getElementById("inserted-detection-instruction").style.display="none"):(document.getElementById("no-inserted-detected").style.display="none",document.getElementById("inserted-detection-instruction").style.display="block"),e.forEach((function(e){var t=p(e.getAttribute("src"));n.push(t)})),n.length!=l.length)t.replaceChildren.apply(t,n),l=n,c=!1;else{for(var i=0;i<n.length;i++)if(n[i].title!=l[i].title)return t.replaceChildren.apply(t,n),l=n,void(c=!1);c=!1}})))}Office.onReady((function(e){if(e.host===Office.HostType.Outlook){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",s(),document.getElementById("inserted-tracking-pixels-container").childNodes.forEach((function(e){l.push(e)}));var t=document.getElementById("insert");r=!1,t.onclick=function(){r||(r=!0,f())},setInterval(s,500)}}));var u="__shrunk_tracking_pixel__";function f(){return n(this,void 0,void 0,(function(){var e,t;return i(this,(function(n){return(e=document.getElementById("tracking-pixel-url")).value=e.value.trim(),t=!1,e.value.match(/(https|http):\/\//)||(Office.context.mailbox.item.notificationMessages.replaceAsync("notify",{type:"informationalMessage",message:"Please enter a valid image url",icon:"iconid",persistent:!1}),t=!0),t?(r=!1,[2]):(o((function(n){if(n.forEach((function(n){if(n.getAttribute("src")==e.value)return Office.context.mailbox.item.notificationMessages.replaceAsync("notify",{type:"errorMessage",message:"Tracking pixel already inserted"}),void(t=!0)})),t)r=!1;else{Office.context.mailbox.item.body.prependAsync('<img title="'.concat(u,'" src="').concat(e.value,'" />'),{coercionType:Office.CoercionType.Html},(function(){r=!1})),Office.context.mailbox.item.notificationMessages.replaceAsync("notify",{type:"informationalMessage",message:"Tracking pixel inserted",persistent:!1,icon:"iconid"});var i=document.getElementById("inserted-tracking-pixels-container"),o=p(e.value);i.appendChild(o)}})),[2])}))}))}function d(e,t,n){Office.context.mailbox.item.body.getAsync("html",{},(function(i){var o=i.value,r=document.createElement("div");r.innerHTML=o;var c=r.querySelector("img[src='".concat(t,"']"));null!=c&&(c.style.border=e,Office.context.mailbox.item.body.setAsync(r.innerHTML,{coercionType:Office.CoercionType.Html},n))}))}function p(e){var t=document.createElement("div");t.title=e;var n=document.createElement("p");n.innerHTML=function(e){return(e=e.replace(/(https|http):\/\//,"")).match(/(shrunk|go)\.rutgers\.edu/)?e.split("/")[1]:e=e.replace("www.","")}(e),t.appendChild(n);var i=document.createElement("button"),o=document.createElement("img");return o.src="../../assets/delete_svg.svg",i.appendChild(o),i.onclick=function(e){e.stopPropagation(),t.remove(),Office.context.mailbox.item.notificationMessages.replaceAsync("notify",{type:"informationalMessage",message:"Tracking pixel removed",persistent:!1,icon:"iconid"}),Office.context.mailbox.item.body.getAsync("html",{},(function(e){var n=e.value,i=document.createElement("div");i.innerHTML=n,i.querySelectorAll("img[title='".concat(u,"']")).forEach((function(e){e.getAttribute("src")==t.title&&e.remove()})),Office.context.mailbox.item.body.setAsync(i.innerHTML,{coercionType:Office.CoercionType.Html})}))},t.onclick=function(){if(!a){var e=t.querySelector("button");d("5px solid red",t.title,(function(){})),e.disabled=!0,t.style.pointerEvents="none",a=!0,setTimeout((function(){t.style.pointerEvents="auto",t.style.border="none",d("",t.title,(function(){a=!1})),e.disabled=!1}),200)}},t.appendChild(i),t}t.insert=f},53407:function(e,t,n){var i=n(34966),o=n.n(i),r=new URL(n(60806),n.b),c=new URL(n(43324),n.b),a=new URL(n(43897),n.b);o()(r),o()(c),o()(a)},34966:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},43324:function(e,t,n){e.exports=n.p+"assets/RUTGERS_H_RED_BLACK_RGB.png"},43897:function(e,t,n){e.exports=n.p+"612bd852153055670686.svg"},60806:function(e,t,n){e.exports=n.p+"05e4a8ee01c4c61da036.css"}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var o=i.length-1;o>-1&&!e;)e=i[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,n(53211),n(53407)}();
//# sourceMappingURL=taskpane.js.map